<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %> | Authentication Template</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <header>
    <nav class="navbar">
        <!-- SEARCH BAR -->
      <form action="/search" method="GET" class="nav-search">
        <input 
          type="text" 
          name="q" 
          placeholder="Search movies..." 
          class="search-input"
          required
        >
        <button type="submit" class="search-btn">Search</button>
      </form>

      <ul class="nav-links">
        <% if (isAuthenticated) { %>
          <li><a href="/home" class="<%= path === '/home' ? 'active' : '' %>">Home</a></li>
          <li><a href="/user/profile" class="<%= path === '/user/profile' ? 'active' : '' %>">Profile</a></li>
          <li><a href="/user/settings" class="<%= path === '/user/settings' ? 'active' : '' %>">Settings</a></li>
          <li><a href="/auth/logout">Logout</a></li>
        <% } else { %>
          <li><a href="/" class="<%= path === '/' ? 'active' : '' %>">Home</a></li>
          <li><a href="/about" class="<%= path === '/about' ? 'active' : '' %>">About</a></li>
          <li><a href="/auth/login" class="<%= path === '/auth/login' ? 'active' : '' %>">Login</a></li>
          <li><a href="/auth/register" class="<%= path === '/auth/register' ? 'active' : '' %>">Register</a></li>
        <% } %>
      </ul>
    </nav>
  </header>


<main>
  <div class="container home-container">

    <!-- Featured Movie -->
    <section class="section featured-section">
      <h1 class="section-title">Featured Movie</h1>

      

    <!-- Trending -->
    <section class="section">
      <h2 class="section-title">Trending Now</h2>
      <p class="section-subtitle">Based on reviews from the last 7 days</p>

      <div class="movie-grid">
        <% if (trendingMovies && trendingMovies.length) { %>
          <% trendingMovies.forEach(movie => { %>
            <article class="movie-card">
              <a href="/movies/<%= movie.id %>" class="movie-poster-link">
                <% if (movie.image) { %>
                  <img src="<%= movie.image %>" alt="<%= movie.title %> poster" class="movie-poster">
                <% } else { %>
                  <div class="movie-poster placeholder">No Image</div>
                <% } %>
              </a>

              <div class="movie-meta">
                <h3 class="movie-title">
                  <a href="/movies/<%= movie.id %>"><%= movie.title %></a>
                </h3>
                <p class="movie-sub">
                  <span><%= movie.year || 'N/A' %></span>
                  <span>‚Ä¢</span>
                  <span><%= movie.rating || 'NR' %></span>
                </p>
                <p class="movie-extra">
                  üî• <%= movie.review_count_week %> reviews this week
                </p>
                <span class="movie-pill">Movie</span>
              </div>
            </article>
          <% }) %>
        <% } else { %>
          <p>No trending movies in the last week.</p>
        <% } %>
      </div>
    </section>

    <!-- Popular -->
    <section class="section">
      <h2 class="section-title">Popular Movies</h2>
      <p class="section-subtitle">Most reviewed movies of all time</p>

      <div class="movie-grid">
        <% if (popularMovies && popularMovies.length) { %>
          <% popularMovies.forEach(movie => { %>
            <article class="movie-card">
              <a href="/movies/<%= movie.id %>" class="movie-poster-link">

                <% if (movie.image) { %>
                  <img src="<%= movie.image %>" alt="<%= movie.title %> poster" class="movie-poster">
                <% } else { %>
                  <div class="movie-poster placeholder">No Image</div>
                <% } %>
              </a>

              <div class="movie-meta">
                <h3 class="movie-title">
                  <a href="/movies/<%= movie.id %>"><%= movie.title %></a>
                </h3>
                <p class="movie-sub">
                  <span><%= movie.year || 'N/A' %></span>
                  <span>‚Ä¢</span>
                  <span><%= movie.rating || 'NR' %></span>
                </p>
                <p class="movie-extra">
                  ‚≠ê <%= movie.review_count_all || 0 %> total reviews
                </p>
                <span class="movie-pill">Movie</span>
              </div>
            </article>
          <% }) %>
        <% } else { %>
          <p>No popular movies yet.</p>
        <% } %>
      </div>
    </section>

  </div>
</main>

<%- include('./partials/footer') %>
